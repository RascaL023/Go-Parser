#!/usr/bin/env bash

# ===============================
# Script helper untuk build/run Go
# ===============================

# Paths
BINARY="bin/renderer"
SRC="./cmd/renderer"

# Function: print usage
usage() {
    echo "Usage: $0 [option]"
    echo "Options:"
    echo "  build       -> Build binary"
    echo "  run         -> Build + run binary"
    echo "  run-bin     -> Run binary only"
    echo "  go-run      -> Run without build"
    echo "  clean       -> Remove binary"    
    exit 1
}

# Ensure bin folder exists
mkdir -p bin

# Check argument
if [ $# -eq 0 ]; then
    usage
fi

case "$1" in
    build)
        echo "[+] Building binary..."
        go build -o "$BINARY" "$SRC"
        echo "[+] Done: $BINARY"
        ;;
    run)
        echo "[+] Building binary..."
        go build -o "$BINARY" "$SRC"
        echo "[+] Running binary..."
        "./$BINARY"
        ;;
    go-run)
        echo "[+] Running without build..."
        go run "$SRC"
        ;;
    clean)
        echo "[+] Removing binary..."
        rm -f "$BINARY"
        ;;
    run-bin)
        echo "[+] Running binary..."
        ./bin/renderer
        ;;
    *)
        usage
        ;;
esac

